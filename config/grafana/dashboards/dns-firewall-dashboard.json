{
  "dashboard": {
    "id": null,
    "title": "DNS Firewall Dashboard",
    "tags": ["dns", "security", "monitoring"],
    "style": "dark",
    "timezone": "browser",
    "panels": [
      {
        "id": 1,
        "title": "DNS Queries Overview",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(rate(dns_queries_total[5m]))",
            "legendFormat": "Queries/sec"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "green", "value": null},
                {"color": "yellow", "value": 80},
                {"color": "red", "value": 90}
              ]
            },
            "unit": "reqps"
          }
        }
      },
      {
        "id": 2,
        "title": "Threat Detection Rate",
        "type": "stat",
        "targets": [
          {
            "expr": "sum(rate(dns_queries_blocked[5m]))",
            "legendFormat": "Blocked/sec"
          }
        ]
      },
      {
        "id": 3,
        "title": "Response Time",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, dns_response_time_bucket)",
            "legendFormat": "95th percentile"
          },
          {
            "expr": "histogram_quantile(0.50, dns_response_time_bucket)",
            "legendFormat": "Median"
          }
        ]
      },
      {
        "id": 4,
        "title": "Cache Performance",
        "type": "graph",
        "targets": [
          {
            "expr": "cache_hit_rate",
            "legendFormat": "Hit Rate %"
          }
        ]
      },
      {
        "id": 5,
        "title": "Top Blocked Domains",
        "type": "table",
        "targets": [
          {
            "expr": "topk(10, sum by (domain) (dns_queries_blocked))",
            "format": "table"
          }
        ]
      },
      {
        "id": 6,
        "title": "Geographic Distribution",
        "type": "piechart",
        "targets": [
          {
            "expr": "sum by (country) (dns_queries_total)",
            "legendFormat": "{{country}}"
          }
        ]
      }
    ],
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "refresh": "10s"
  }
}